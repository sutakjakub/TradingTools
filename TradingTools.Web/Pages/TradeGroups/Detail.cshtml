@page "{id:long}"
@model TradingTools.Web.Pages.TradeGroupDetail.DetailModel
@{
}

<div>
    <h1>
        @Model.TradeGroup.Name
    </h1>
    <h4>@Model.TradeGroup.SymbolInfo?.Symbol</h4>
    <div class="float-right">
        <table>
            <tr>
                <td>Average Price</td>
                <td>@Model.TradeSummary.AveragePrice</td>
            </tr>
            <tr>
                <td>Current symbol price</td>
                <td>@Model.TradeSummary.CurrentSymbolPrice</td>
            </tr>
            <tr>
                <td>Gain (%)</td>
                <td>@Model.TradeSummary.GainPercentage</td>
            </tr>
        </table>
    </div>
</div>

<table class="table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Symbol</th>
            <th>Side</th>
            <th>Price</th>
            <th>Quantity</th>
            <th>Quote Quantity</th>
            <th>Commission</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var trade in Model.TradeGroup.Trades)
        {
            <tr>
                <td>@trade.TradeTime.ToString("u")</td>
                <td>@trade.Symbol</td>
                <td>
                    @if (@trade.IsBuyer)
                    {
                        <span class="bg-success text-light pl-2 pr-2">BUY</span>
                    }
                    else
                    {
                        <span class="bg-danger text-light pl-2 pr-2">SELL</span>
                    }
                </td>
                <td>@trade.Price @trade.T2SymbolInfo.QuoteAsset</td>
                <td>@trade.Quantity @trade.T2SymbolInfo.BaseAsset</td>
                <td>@trade.QuoteQuantity @trade.T2SymbolInfo.QuoteAsset</td>
                <td>@trade.Commission @trade.CommissionAsset</td>
            </tr>
        }
    </tbody>
</table>

@if (@Model.Trades?.Any() == true)
{
    <form asp-page-handler="assign" method="post">
        <input type="hidden" name="id" value="@Model.TradeGroup.Id" />
        <button class="btn btn-default">Assign to group</button>
        <table class="table">
            <thead>
                <tr>
                    <th></th>
                    <th>TradeTime</th>
                    <th>TradeGroup</th>
                    <th>Symbol</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>QuoteQuantity</th>
                    <th>Commission</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var trade in Model.Trades)
                {
                    <tr>
                        <td><input name="AreChecked" type="checkbox" value="@trade.Id" /></td>
                        <td>@trade.TradeTime</td>
                        <td><a asp-page="/TradeGroups/Detail" asp-route-id="@trade.T2TradeGroup.Id">@trade.T2TradeGroup.Name</a></td>
                        <td>@trade.Symbol</td>
                        <td>@trade.Price @trade.T2SymbolInfo.QuoteAsset</td>
                        <td>@trade.Quantity</td>
                        <td>@trade.QuoteQuantity</td>
                        <td>@trade.Commission @trade.CommissionAsset</td>
                    </tr>
                }
            </tbody>
        </table>
    </form>
}

